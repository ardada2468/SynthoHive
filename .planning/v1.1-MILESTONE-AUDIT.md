---
milestone: v1.1 (Phase 02 — Relational Correctness)
audited: 2026-02-23T02:45:00Z
status: tech_debt
scope_note: "Phase 02 (5/5 plans complete). Phase 03 (Model Pluggability) is part of v1.1 scope per ROADMAP but not yet executed — not audited here."
scores:
  requirements: 7/7
  phases: 1/1
  integration: 5/7
  flows: 3/4
gaps: []
tech_debt:
  - phase: 02-relational-correctness
    items:
      - "REL-03 partial wiring: validate_schema() not called inside Synthesizer.fit() — FK type mismatches only caught if caller explicitly calls validate_schema() pre-fit; production guard absent from façade"
      - "SchemaValidationError missing from syntho_hive/__init__.py public exports — callers doing `from syntho_hive import SchemaValidationError` receive ImportError; must use `from syntho_hive.exceptions import SchemaValidationError` instead"
      - "4 pre-existing test failures in test_interface.py: ValueError raised inside Synthesizer.fit()/sample() is re-wrapped as TrainingError; tests expecting ValueError receive TrainingError instead — pre-dates Phase 02"
      - "Human verification outstanding: production-scale FK chain test (10k+ rows) to confirm zero-orphan guarantee at realistic dataset size and full training epochs"
---

# Milestone Audit: v1.1 Phase 02 — Relational Correctness

**Audited:** 2026-02-23
**Scope:** Phase 02 (5/5 plans complete) | v1.1 Phase 03 (Model Pluggability) pending
**Status:** `tech_debt` — all 7 Phase 02 requirements satisfied; 2 integration gaps accumulated

---

## Requirements Coverage

### 3-Source Cross-Reference

All 7 Phase 02 requirements verified against: VERIFICATION.md, SUMMARY frontmatter, ROADMAP traceability.

| Requirement | Description | SUMMARY | VERIFICATION | ROADMAP | → Status |
|-------------|-------------|---------|-------------|---------|---------|
| REL-01 | Fresh parent context per generator step | 02-02 ✓ | SATISFIED | Phase 2 | **satisfied** |
| REL-02 | Empirical/NegBinom cardinality (not Gaussian Mixture) | 02-03 ✓ | SATISFIED | Phase 2 | **satisfied** |
| REL-03 | FK type mismatches raised at validate_schema() | 02-01, 02-05 ✓ | SATISFIED | Phase 2 | **satisfied** |
| REL-04 | Memory-safe DataFrames released after disk write | 02-02 ✓ | SATISFIED | Phase 2 | **satisfied** |
| REL-05 | Zero orphaned FK references in generated tables | 02-04 ✓ | SATISFIED | Phase 2 | **satisfied** |
| CONN-02 | PySpark 4.0+ / delta-spark 4.0+ pins match venv | 02-02 ✓ | SATISFIED | Phase 2 | **satisfied** |
| TEST-02 | Multi-table E2E: 3-table FK zero-orphan test passes | 02-04, 02-05 ✓ | SATISFIED | Phase 2 | **satisfied** |

**Score: 7/7 requirements satisfied. No orphaned requirements. No unsatisfied requirements.**

---

## Phase Verification Summary

| Phase | Plans | VERIFICATION.md | Score | Status |
|-------|-------|----------------|-------|--------|
| 02-relational-correctness | 5/5 | present | 5/5 | ✓ passed |

---

## Integration Check Summary

| Check | Result | Affected Reqs |
|-------|--------|---------------|
| SchemaValidationError import chain (02-01 → consumers) | PARTIAL — correct in tests; missing from `__init__.py` | REL-03, TEST-02 |
| linkage_method → LinkageModel wiring (02-01 → 02-03) | FULLY WIRED | REL-02 |
| IO injection pattern (02-02 → 02-04 tests) | FULLY WIRED | REL-04, REL-05, TEST-02 |
| E2E flow: validate_schema() → fit() → generate() → join | BROKEN at first step — validate_schema() not called in Synthesizer.fit() | REL-03 |
| Phase 01 regression check | NO REGRESSIONS — base hierarchy and Synthesizer public API intact | all |

---

## Tech Debt Details

### 1. validate_schema() Not Wired into Synthesizer.fit()

**File:** `syntho_hive/interface/synthesizer.py`, lines 84–105
**Severity:** Notable — affects real-world protection for REL-03

`Synthesizer.fit()` never calls `self.metadata.validate_schema()`. The method exists on `Metadata` and raises `SchemaValidationError` correctly when called, but the façade doesn't invoke it automatically. A caller can pass type-mismatched FK schemas to `fit()` and discover the error only after GPU training time is spent, or not at all (if the mismatch doesn't surface as a crash).

Fix: Add `self.metadata.validate_schema(real_data)` call early in `Synthesizer.fit()`, before `self.orchestrator.fit_all()`.

### 2. SchemaValidationError Missing from Package Public Export

**File:** `syntho_hive/__init__.py`
**Severity:** Usability — inconsistent with rest of exception hierarchy

All other exception types (`SynthoHiveError`, `SchemaError`, `TrainingError`, `SerializationError`, `ConstraintViolationError`) are re-exported from `syntho_hive.__init__`. `SchemaValidationError` is absent. Callers doing `from syntho_hive import SchemaValidationError` receive `ImportError`. The correct import works (`from syntho_hive.exceptions import SchemaValidationError`) but is inconsistent.

Fix: Add `SchemaValidationError` to the imports in `syntho_hive/__init__.py`.

### 3. Pre-existing: 4 Failing Tests in test_interface.py

**File:** `syntho_hive/tests/test_interface.py`
**Severity:** Low — pre-dates Phase 02; confirmed no regression

`ValueError` raised in `Synthesizer.fit()` and `sample()` is not a `SynthoHiveError` subclass, so it passes through `except Exception as exc: raise TrainingError(...)`. Tests expecting `ValueError` receive `TrainingError`. This is a design inconsistency in the Synthesizer exception-handling wrapper — out of Phase 02 scope.

### 4. Human Verification Pending

**From VERIFICATION.md:** Production-scale FK chain test (10,000+ rows) not yet run.
**Why:** Automated tests use `epochs=2`, `batch_size=20`, and 5–20 parent rows. Real-world scale may expose timing, memory, or join-key assignment issues invisible at small scale.

---

## Anti-Patterns

| File | Issue | Severity |
|------|-------|----------|
| `test_interface.py:49,54` | 4 pre-existing failures — ValueError wrapped as TrainingError | INFO (pre-existing) |
| `test_relational.py` | ConvergenceWarning from sklearn GMM in DataTransformer during test output | INFO (non-fatal, unrelated to LinkageModel) |

---

## Phase 03 Pending (v1.1 remaining scope)

Phase 03 (Model Pluggability) is part of v1.1 per ROADMAP.md but has not been planned or executed. Requirements pending:

| Requirement | Description |
|-------------|-------------|
| MODEL-01 | StagedOrchestrator accepts model_cls parameter — no hardcoded CTGAN |
| MODEL-02 | Synthesizer exposes model parameter with documented supported classes |
| MODEL-03 | Any class implementing ConditionalGenerativeModel ABC routes correctly |

These are **not included in this audit** — they are not part of Phase 02's scope.

---

*Audited: 2026-02-23*
*Auditor: Claude (gsd-integration-checker + orchestrator)*
